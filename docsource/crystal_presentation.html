
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172053863-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-172053863-1');
</script>
  
  
    <title>&lt;no title&gt; &#8212; kALDo  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="amorphous_presentation.html" />
    <link rel="prev" title="Conductivity API Reference" href="api_conductivity.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#docsource/crystal_presentation" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="kALDo  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">kALDo</span>
          <span class="md-header-nav__topic"> &lt;no title&gt; </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/nanotheorygroup/kaldo" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kALDo
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">kALDo  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="kALDo documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="kALDo documentation">kALDo</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/nanotheorygroup/kaldo" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kALDo
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">API</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_forceconstants.html" class="md-nav__link">ForceConstants API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_phonons.html" class="md-nav__link">Phonons API Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_conductivity.html" class="md-nav__link">Conductivity API Reference</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/docsource/crystal_presentation.ipynb.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“collapsed”: false</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“This notebook can be run on Google Colab.n”,
“n”,
“[![Open in Colab](<a class="reference external" href="https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/nanotheorygroup/kaldo/blob/master/docs/docsource/crystal_presentation.ipynb)n">https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/nanotheorygroup/kaldo/blob/master/docs/docsource/crystal_presentation.ipynb)n</a>”,
“n”,
“n”,
“n”,
“In Colab, you can enable the GPU acceleration from <img alt="Edit" class="math" src="../_images/math/87442c1d546f5bb17eb1e69b21f1e03c307578ad.png"/> &gt; <img alt="Notebook Settings" class="math" src="../_images/math/39e0be35e1ad9d4c9ecfbc817a0dcf3441bb7184.png"/> &gt; <img alt="Accelerator" class="math" src="../_images/math/57cb24c5cb8afbbb266375e7093bc93950e93bb0.png"/> &gt; <img alt="GPU" class="math" src="../_images/math/081b8fbbfe6b7bbdfe03c030a7b4e7d858f75960.png"/>.”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “7tmSqc3aRYYC”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“# Silicon diamond tutorialn”,
“n”,
“## Remote fetch source code from Github”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “7SHu3FQYReZC”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“! pip install git+https://github.com/nanotheorygroup/kaldo”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “<a href="#id7"><span class="problematic" id="id8">W3jVRdQg1US_</span></a>”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“## Remote fetch supplyment filesn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “n4PN3gLv08-r”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Remote fetch kaldo resources from drop boxn”,
“! wget <a class="reference external" href="https://www.dropbox.com/s/bvw0qcxy397g25q/kaldo_resources.zip?dl=0n">https://www.dropbox.com/s/bvw0qcxy397g25q/kaldo_resources.zip?dl=0n</a>”,
“! mv kaldo_resources.zip?dl=0 kaldo_resources.zipn”,
“! unzip kaldo_resources.zipn”,
“n”,
“# Copy files from to the workspacen”,
“! cp -r kaldo_resources/forcefields.zip ./n”,
“n”,
“# Unzip filesn”,
“!unzip forcefields.zipn”,
“n”,
“# Clean workspacen”,
“! rm -r forcefields.zipn”,
“! rm -r structure_a_si_512.zipn”,
“! rm -r kaldo_resources.zipn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “QNd3HLW992Av”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“## Remote fetch precomplied LAMMPSn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “l3yNjxeR9-m-”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Fetch prebuild lammps binary files from dropbox n”,
“! wget <a class="reference external" href="https://www.dropbox.com/s/cqqhh1ax5er0u8b/lmp-tesla-t4-intel-xeon.gz?dl=0n">https://www.dropbox.com/s/cqqhh1ax5er0u8b/lmp-tesla-t4-intel-xeon.gz?dl=0n</a>”,
“! mv lmp-tesla-t4-intel-xeon.gz?dl=0 lmp-tesla-t4-intel-xeon.gzn”,
“! tar xvzf lmp-tesla-t4-intel-xeon.gzn”,
“! rm /content/lmp-tesla-t4-intel-xeon.gzn”,
“n”,
“# Navigate back to lammps source foder when for n”,
“# later LAMMPS-Python integrationn”,
“%cd /content/lammps/srcn”,
“n”,
“print(’\n’)n”,
“print(‘Remote Fetching precomplied LAMMPS is finished!’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “N45o6ZTG_6w7”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“## Integrate LAMMPS Into Python “</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “HN8HfxJN_7dU”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“! make install-pythonn”,
“n”,
“# Copy executable file to where the python Module locatesn”,
“import shutil n”,
“src_path = ‘/usr/lib/python3/dist-packages/liblammps.so’n”,
“dist_path = ‘/usr/local/lib/python3.7/dist-packages/liblammps.so’n”,
“shutil.copyfile(src_path,dist_path)n”,
“n”,
“# Naviagate back to main folder before simulationn”,
“%cd /contentn”,
“print(’\n’)n”,
“print(‘LAMMPS-Python Integration is completed!’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “FlzbvmDEACjK”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“## Thermal transport simulation for silicon-bulk”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “uzhWN30mYhsT”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Compute $2^{nd}$ and $3^{rd}$ order IFCS.”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “pznkqF7TYg7c”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from ase.build import bulkn”,
“from ase.calculators.lammpslib import LAMMPSlibn”,
“from kaldo.forceconstants import ForceConstantsn”,
“import numpy as npn”,
“n”,
“# We start from the atoms objectn”,
“atoms = bulk(‘Si’, ‘diamond’, a=5.432)n”,
“n”,
“# Config super cell and calculator inputn”,
“supercell = np.array([3, 3, 3])n”,
“lammps_inputs = {n”,
”      ‘lmpcmds’: [n”,
”          ‘pair_style tersoff’,n”,
”          ‘pair_coeff * * forcefields/Si.tersoff Si’],n”,
“n”,
”      ‘log_file’: ‘lammps-si-bulk.txt’,n”,
”      ‘keep_alive’:True}n”,
“n”,
“# Create a finite difference objectn”,
“forceconstants_config  = {‘atoms’:atoms,’supercell’: supercell,’folder’:’fd’}n”,
“forceconstants = ForceConstants(<a href="#id1"><span class="problematic" id="id2">**</span></a>forceconstants_config)n”,
“n”,
“# Compute 2nd and 3rd IFCs with the defined calculatorsn”,
“forceconstants.second.calculate(LAMMPSlib(<a href="#id3"><span class="problematic" id="id4">**</span></a>lammps_inputs), delta_shift=1e-4)n”,
“forceconstants.third.calculate(LAMMPSlib(<a href="#id5"><span class="problematic" id="id6">**</span></a>lammps_inputs), delta_shift=1e-4)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “nMaD_Vp3Yq8M”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Create phonons objectn”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 7,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “wmohtOrZYqB9”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from kaldo.phonons import Phononsn”,
“n”,
“# Define k-point grids, temperaturen”,
“# and the assumption for the n”,
“# phonon poluation (i.e classical vs. quantum)n”,
“k = 7n”,
“kpts = [k, k, k]n”,
“temperature = 300n”,
“is_classic = Falsen”,
“k_label = str(k) + ‘_’ + str(k) + ‘_’ + str(k)n”,
“n”,
“# Create a phonon objectn”,
“phonons = Phonons(forceconstants=forceconstants,n”,
”                kpts=kpts,n”,
”                is_classic=is_classic,n”,
”                temperature=temperature,n”,
”                folder=’si-bulk-ald-’ + k_label,n”,
”                storage=’numpy’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “NO5weMg1YbjD”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Calculate conductivities for infinite-size samplen”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “r4DQJ9R8_LSs”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“from kaldo.conductivity import Conductivityn”,
“n”,
“# Calculate conductivity  with direct inversion approach (inverse)n”,
“print(’\n’)n”,
“inv_cond_matrix = (Conductivity(phonons=phonons, method=’inverse’).conductivity.sum(axis=0))n”,
“print(‘Inverse conductivity (W/mK): %.3f’%(np.mean(np.diag(inv_cond_matrix))))n”,
“print(inv_cond_matrix)n”,
“n”,
“# Calculate conductivity  with  relaxation time approximation (rta)n”,
“print(’\n’)n”,
“rta_cond_matrix = Conductivity(phonons=phonons, method=’rta’).conductivity.sum(axis=0)n”,
“print(‘Rta conductivity (W/mK): %.3f’%(np.mean(np.diag(rta_cond_matrix))))n”,
“print(rta_cond_matrix)n”,
“# Calculate conductivity  with  self-consistent approach (sc)n”,
“n”,
“print(’\n’)n”,
“sc_cond_matrix = Conductivity(phonons=phonons, method=’sc’,n_iterations=20).conductivity.sum(axis=0)n”,
“print(‘Self-consistent conductivity (W/mK): %.3f’%(np.mean(np.diag(sc_cond_matrix))))n”,
“print(sc_cond_matrix)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “C7Cyk7teqqbO”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Visualize harmonic properties using built-in plottern”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “vPF77pJPpeXk”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“import kaldo.controllers.plotter as plottern”,
“import matplotlib.pyplot as pltn”,
“plt.style.use(‘seaborn-poster’)n”,
“n”,
“# Plot dispersion relation and group velocity in each directionn”,
“plotter.plot_dispersion(phonons,n_k_points=int(k_label))n”,
“print(’\n’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “OMgSvwd3q4jN”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Access and visualize properties calculated during simulations”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “WWi2-O99HQv3”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Direct access to propertiesn”,
“# calculated during the simulationn”,
“n”,
“# Plot heat capacity vs frequencyn”,
“freq_full = phonons.frequency.flatten(order=’C’)n”,
“cv_1d = phonons.heat_capacity.flatten(order=’C’)[3:]n”,
“n”,
“print(’\n’)n”,
“plt.figure()n”,
“plt.scatter(freq_full[3:],1e23*cv_1d,s=15)n”,
“plt.ylabel (r"$C_{v}$ ($10^{23}$ J/K)", fontsize=25, fontweight=’bold’)n”,
“plt.xlabel ("$\\nu$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.ylim(0.9*1e23*cv_1d[cv_1d&gt;0].min(), n”,
”         1.05*1e23*cv_1d.max())n”,
“plt.show()n”,
“n”,
“# Plot phonon bandwidth vs frequencyn”,
“band_width_flatten = phonons.bandwidth.flatten(order=’C’)n”,
“freq = freq_full[band_width_flatten!=0]n”,
“n”,
“print(’\n’)n”,
“plt.figure()n”,
“plt.scatter(freq,band_width_flatten[band_width_flatten!=0] ,s=15)n”,
“plt.ylabel (r"$\Gamma$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.xlabel ("$\\nu$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.ylim(0.95*band_width_flatten .min(), 1.05*band_width_flatten .max())n”,
“plt.show()n”,
“n”,
“# Plot phase space vs frequencyn”,
“print(’\n’)n”,
“plt.figure()n”,
“plt.scatter(freq_full[3:],phonons.phase_space.flatten(order=’C’)[3:],s=15)n”,
“plt.ylabel ("Phase space", fontsize=25, fontweight=’bold’)n”,
“plt.xlabel ("$\\nu$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.ylim(phonons.phase_space.min(), phonons.phase_space.max())n”,
“plt.show()”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {</p>
<blockquote>
<div><p>“colab_type”: “text”,
“id”: “N8CQx70vPKqO”</p>
</div></blockquote>
<p>},
“source”: [</p>
<blockquote>
<div><p>“### Calculate and visualize $\kappa_{per \ mode}$ and $\kappa_{cum}$”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 11,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “hf_1RScJJOCX”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“def cumulative_cond_cal(freq,full_cond,n_phonons):n”,
“n”,
”  conductivity = np.einsum(‘maa-&gt;m’, 1/3 * full_cond)n”,
”  conductivity = conductivity.reshape(n_phonons)n”,
”  cumulative_cond = np.zeros_like(conductivity)n”,
”  freq_reshaped = freq.reshape(n_phonons)n”,
“n”,
”  for mu in range(cumulative_cond.size):n”,
”      single_cumulative_cond = conductivity[(freq_reshaped &lt; freq_reshaped[mu])].sum()n”,
”      cumulative_cond[mu] = single_cumulative_condn”,
”  n”,
”  return cumulative_cond”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {</p>
<blockquote>
<div><p>“colab”: {},
“colab_type”: “code”,
“id”: “CbCO9cIsPrVP”</p>
</div></blockquote>
<p>},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Compute conductivity with per phonon mode basis using different methodsn”,
“kappa_rta_per_mode = np.einsum(‘maa-&gt;m’,1/3*Conductivity(phonons=phonons, method=’rta’).conductivity)n”,
“kappa_inv_per_mode = np.einsum(‘maa-&gt;m’,1/3*Conductivity(phonons=phonons, method=’inverse’).conductivity)n”,
“kappa_sc_per_mode = np.einsum(‘maa-&gt;m’,1/3*Conductivity(phonons=phonons, method=’sc’,n_iterations=20).conductivity)n”,
“n”,
“# Compute cumulative conductivity by frequency using different methodsn”,
“kappa_rta_cum_freq = cumulative_cond_cal(phonons.frequency,Conductivity(phonons=phonons, method=’rta’).conductivity,phonons.n_phonons)n”,
“kappa_sc_cum_freq = cumulative_cond_cal(phonons.frequency,Conductivity(phonons=phonons, method=’sc’,n_iterations=20).conductivity,phonons.n_phonons)n”,
“kappa_inv_cum_freq = cumulative_cond_cal(phonons.frequency,Conductivity(phonons=phonons, method=’inverse’).conductivity,phonons.n_phonons)n”,
“kappa_qhgk_cum_freq = cumulative_cond_cal(phonons.frequency,Conductivity(phonons=phonons, method=’qhgk’).conductivity,phonons.n_phonons)n”,
“print(’\n’)n”,
“n”,
“# Visualize the cumulative conductivity vs frequencyn”,
“plt.figure()n”,
“plt.plot(freq_full,kappa_rta_per_mode,’r.’,label=’RTA’)n”,
“plt.plot(freq_full,kappa_sc_per_mode,’mo’,label=’Self Consistent’,ms=8)n”,
“plt.plot(freq_full,kappa_inv_per_mode,’k.’,label=’Direct Inversion’)n”,
“plt.xlabel ("$\\nu$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.ylabel(r’$\kappa(W/m/K)$’, fontsize=25, fontweight=’bold’)n”,
“plt.legend(loc=1,frameon=False)n”,
“#plt.grid()n”,
“plt.show()n”,
“print(’\n’)n”,
“n”,
“# Visualize the cumulative conductivity vs frequencyn”,
“plt.figure()n”,
“plt.plot(freq_full,kappa_rta_cum_freq,’r.’,label=’RTA’)n”,
“plt.plot(freq_full,kappa_sc_cum_freq,’mo’,label=’Self Consistent’,ms=8)n”,
“plt.plot(freq_full,kappa_inv_cum_freq,’k.’,label=’Direct Inversion’)n”,
“plt.xlabel ("$\\nu$ (Thz)", fontsize=25, fontweight=’bold’)n”,
“plt.ylabel(r’$\kappa_{cum}(W/m/K)$’, fontsize=25, fontweight=’bold’)n”,
“plt.legend(loc=4,frameon=False)n”,
“plt.grid()n”,
“plt.show()”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“colab”: {</dt><dd><p>“collapsed_sections”: [],
“name”: “crystal_presentation.ipynb”,
“provenance”: [],
“toc_visible”: true</p>
</dd>
</dl>
<p>},
“kernelspec”: {</p>
<blockquote>
<div><p>“display_name”: “Python 3”,
“name”: “python3”</p>
</div></blockquote>
<p>},
“pycharm”: {</p>
<blockquote>
<div><dl>
<dt>“stem_cell”: {</dt><dd><p>“cell_type”: “raw”,
“metadata”: {</p>
<blockquote>
<div><p>“collapsed”: false</p>
</div></blockquote>
<p>},
“source”: []</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 0</p>
</dd>
</dl>
<p>}</p>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="api_conductivity.html" title="Conductivity API Reference"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Conductivity API Reference </span>
              </div>
            </a>
          
          
            <a href="amorphous_presentation.html" title="&lt;no title&gt;"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> &lt;no title&gt; </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, Giuseppe Barbalinardo, Zekun Chen, Nicholas W. Lundgren, Davide Donadio.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>